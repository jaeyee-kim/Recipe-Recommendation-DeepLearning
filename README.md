# Recipe-Recommendation-DeepLearning
식재료 기반 딥러닝 레시피 추천 시스템
## 프로젝트 개요
이 프로젝트는 사용자가 가진 남은 식재료를 효율적으로 활용하고, 음식물 쓰레기를 줄이는 데 기여하기 위해 기획되었습니다. 사용자가 직접 찍은 사진 속 식재료를 딥러닝 모델로 인식하고, 인식된 식재료를 기반으로 맞춤형 레시피를 추천해주는 시스템을 개발합니다. 특히, YOLO기반의 객체 인식 모델과 LLM(Large Language Model)을 활용하여 더욱 정확하고 유용한 레시피 추천 서비스를 제공하는 것을 목표로 합니다.

## 목차
1. [프로젝트 목표](# -프로젝트-목표)
2. [데이터 수집 및 라벨링](# -데이터-수집-및-라벨링)
3. [모델링(YOLO)](# -모델링-yolo)
4. [LLM 모델 적용](# -llm-모델-적용)
5. [예상되는 기대효과 및 한계](# -예상되는-기대효과-및-한계)

## 1.프로젝트 목표

### 문제 정의
많은 사람들이 다음과 같은 문제에 직면하고 있습니다:
* 남은 식재료 활용의 어려움 : 냉장고에 남은 식재료가 있어도 어떤 요리를 해야 할지 막막하여 방치되는 경우가 많습니다.
* 음식물 쓰레기 증가 : 사다 놓은 식재료가 기간 내에 소비되지 못하고 버려져 불필요한 음식물 쓰레기가 발생하는 경우가 빈번합니다. 이는 경제적 손실뿐만 아니라 환경 문제로도 이어집니다.

### 프로젝트 목표
위와 같은 문제들을 해결하기 위해, 본 프로젝트는 다음과 같은 목표를 설정하였습니다:
* 식재료 인식 및 레시피 추천 사용자가 스마트폰으로 냉장고 속 식재료를 촬영하면, 사진 속 식재료를 정확하게 인식합니다.
* YOLO 기반 딥러닝 모델 활용 : 객체 인식에 최적화된 YOLO(You Only Look Once) 모델을 활용하여 식재료를 빠르고 정확하게 탐지합니다.
* LLM 연동 : 인식된 식재료를 기반으로 다양한 레시피를 생성하고 추천하기 위해 LLM을 연동하여 사용자에게 맞춤형 요리 아이디어를 제공합니다.
* 효율적인 식재료 소비 유도 : 사용자에게 실용적인 레시피를 제공함으로써 식재료 활용도를 높이고, 음식물 쓰레기를 줄이는 데 기여합니다.

## 2. 데이터 수집 및 라벨링

### 데이터셋 구축 과정
본 프로젝트의 핵심인 식재료 인식 모델 학습을 위해 고품질의 식재료 이미지 데이터셋을 구축하였습니다.
초기에는 직접 웹 크롤링을 통해 데이터를 수집하고 LabelImg를 사용하여 라벨링을 진행할 계획이었습니다. 하지만 LabelImg 사용 중 클래스명 꼬임 현상과 같은 이슈가 발생하여, 효율적인 데이터 확보와 라벨링 품질 유지를 위해 Roboflow 플랫폼으로 전환하여 공개 데이터셋을 활용하고, 직접 크롤링한 한국 식재료 데이터셋도 Roboflow를 통해 관리하는 방향으로 전략을 변경하였습니다.

#### 2.1. Roboflow 공개 데이터셋 활용
주로 다양한 채소와 과일 이미지를 포함하고 있는 Roboflow Universe의 공개 데이터셋을 활용하였습니다.
* 출처 : Combined Vegetables & Fruits Object Detection Dataset by Yolo
* 구성 : Train : 34,008개 이미지
         Validation : 4,619개 이미지
         Test : 3,358개 이미지
         총계 : 41,985개 이미지

#### 2.2. 직접 크롤링한 한국 식재료 데이터셋
한국 요리에 자주 사용되는 식재료의 다양성을 확보하기 위해 직접 웹 크롤링을 통해 이미지를 수집하고 라벨링하여 데이터셋을 보강하였습니다.
* 출처 : 웹 크롤링을 통해 직접 수집 및 라벨링 (My First Project Object Detection Dataset by kim)
* 구성 : Train: 635개 이미지
         Validation: 151개 이미지
         Test: 993개 이미지
         총계 : 1,779개 이미지

#### 2.3. 최종 통합 데이터셋
위 두 데이터셋을 통합하여 최종 학습에 사용된 데이터셋의 규모는 다음과 같습니다.
* Train: 34,643개 이미지 (34,008 + 635)
* Validation: 4,770개 이미지 (4,619 + 151)
* Test: 3,565개 이미지 (3,358 + 993)
* 전체 총계 : 42,978개 이미지

### 라벨링 클래스
본 프로젝트에서는 총 50가지의 다양한 식재료 클래스를 인식하도록 모델을 학습시켰습니다. 학습에 사용된 식재료 클래스는 다음과 같습니다: 
``` 
'almond', 'apple', 'asparagus', 'avocado', 'banana', 'beans', 'beet', 'bell pepper',
'blackberry', 'blueberry', 'broccoli', 'brussels sprouts', 'cabbage', 'carrot',
'cauliflower', 'celery', 'cherry', 'corn', 'cucumber', 'egg', 'eggplant', 'garlic',
'grape', 'green bean', 'green onion', 'hot pepper', 'kiwi', 'lemon', 'lettuce', 'lime',
'mandarin', 'mushroom', 'onion', 'orange', 'pattypan squash', 'pea', 'peach', 'pear',
'pineapple', 'potato', 'pumpkin', 'radish', 'raspberry', 'strawberry', 'tomato',
'vegetable marrow', 'watermelon', 'kimchi', 'seaweed', 'tobu' 
```

### 라벨링 툴 및 과정
데이터 라벨링은 객체 탐지 모델 학습의 핵심 단계로, 정확하고 일관된 라벨링이 모델 성능에 큰 영향을 미칩니다.

* LabelImg 시도 및 한계 : 프로젝트 초기에는 오프라인 라벨링 툴인 LabelImg를 사용하여 직접 수집한 이미지에 대한 라벨링을 시도했습니다. 하지만 대규모 데이터셋 관리 및 클래스명 일관성 유지 과정에서 클래스명 꼬임, 버전 관리의 어려움 등 여러 이슈에 직면했습니다.
* Roboflow로의 전환 : 이러한 문제점을 해결하고 라벨링 효율성을 높이기 위해 Roboflow 플랫폼을 도입했습니다. Roboflow는 웹 기반의 강력한 라벨링 기능을 제공하며, 특히 YOLO 형식의 라벨링 데이터를 효율적으로 관리하고 내보낼 수 있는 장점이 있었습니다. 직접 크롤링한 한국 식재료 데이터셋 또한 Roboflow를 통해 라벨링 및 검수 과정을 거쳤습니다.
* 라벨링 형식 : 모든 라벨링은 YOLO 모델 학습에 필요한 바운딩 박스(Bounding Box) 형식으로 진행되었으며, 각 이미지에 해당하는 `.txt` 파일로 저장되었습니다.

  

